<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
  <!-- Compiled and minified CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

   <!-- Compiled and minified JavaScript -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>


  <!-- <link rel="stylesheet" href="css/styles.css?v=1.0"> -->
  <style>
  .upload-btn-wrapper {
    position: relative;
    overflow: hidden;
    display: inline-block;
  }

  .btn {
    border: 2px solid gray;
    color: gray;
    background-color: white;
    padding: 100px 100px 150px 100px;
    border-radius: 8px;
    font-size: 100px;
    font-weight: bold;
  }

  .upload-btn-wrapper input[type=file] {
    font-size: 100px;
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
  }
  </style>

</head>

<body>

    <div style="text-align: center; margin-top: 50px">
      <div class="upload-btn-wrapper">
        <button class="btn">Upload a file</button>
        <input type="file" name="img" id="myFile" multiple />
      </div>
    </div>

    <div  id="loader" style="display: none;">
      <div style="text-align: center; margin-top: 50px">
      <div  class="preloader-wrapper big active">
        <div class="spinner-layer spinner-blue-only">
          <div class="circle-clipper left">
            <div class="circle"></div>
          </div><div class="gap-patch">
            <div class="circle"></div>
          </div><div class="circle-clipper right">
            <div width="500px" height="500px" class="circle"></div>
          </div>
        </div>
      </div>
    </div>
    </div>



  <p id="demo"></p>
  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script  src="https://www.gstatic.com/firebasejs/6.1.0/firebase.js"></script>
  <!-- <script  src="./init-firebase.js"></script> -->

  <script>

  console.log(window.location.search);
  var par = window.location.search;
  par = par.replace("?id=", "");

  var config = {
    apiKey: "AIzaSyAVVFwh_PmRuKlsMF7sOAAUkDn5eVj0zd4",
    authDomain: "copygeneral-f7c91.firebaseapp.com",
    projectId: "copygeneral-f7c91",
    storageBucket: "copygeneral-f7c91.appspot.com",
    databaseURL: "copygeneral-f7c91.firebaseio.com"
  };
  firebase.initializeApp(config);

  // Get a reference to the database service
  var database = firebase.database();
  var storageRef = firebase.storage().ref();

  // var bytes = new Uint8Array([0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21]);


  document.getElementById('myFile').onchange = function (evt) {
  document.getElementById('loader').style.display = "block";
  console.log('Start uploaded a blob or file!');
        var tgt = evt.target || window.event.srcElement,
            files = tgt.files,
            fl = files.length;
            for(var i = 0; i < fl; i++){
              storageRef.child(par + "_" + i +".jpg").put(files[i]).then(function(snapshot) {
                console.log('Uploaded an array!');
              });
            }


        // FileReader support
        // if (FileReader && files && fl) {
        //     var fr = new FileReader();
        //     fr.onload = function () {
        //         console.log(fr.result);
        //
        //     }
        //     fr.readAsDataURL(files[0]);
        // } else {
        //     // fallback -- perhaps submit the input to an iframe and temporarily store
        //     // them on the server until the user's session ends.
        // }
    }

  function myFunction() {

    var x = document.getElementById("myFile").files;


    var file = x[0]; // use the Blob or File API


  }
  </script>
</body>
</html>
